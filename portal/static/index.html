<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="Company" content="Almende BV">
    <meta name="Author" content="Luis F. M. Cunha">
    <title>Portal</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="vendor/bootstrap4/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="vendor/jquery/jquery-3.3.1.min.js"></script>
    <!-- Popper JS -->
    <script src="vendor/pooper/popper.min.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="vendor/bootstrap4/bootstrap.min.js"></script>

    <!-- my Styles -->
    <link rel="stylesheet" href="./css/portalStyles.css">

    <script src="/aim/auth/js/keycloak.js"></script>

    <script>
        var keycloak = Keycloak("/keycloak.json");
        keycloak.init({onLoad:"check-sso"}).success(function(authenticated) {
            console.log('KeyCloak initialized,',(authenticated?this.keycloak.idTokenParsed.preferred_username:"-none-"),"authenticated.");
        }).error(function() {
            console.log('KeyCloak failed to initialize');
        });


        keycloak.onAuthSuccess = function () {

            console.log("I'm in onAuthSuccess!!!!");
            if (keycloak.authenticated) {
                // Show user menus
                $("#login").hide();
                document.getElementById('username').innerHTML = keycloak.idTokenParsed.preferred_username;
                $("#userMenu").show();



                // Show containers info
                $("#tableDiv").show();
                //loadingBar();

                // Start timer to update containers info
                // update stats history
                //setTimeout(updateStatsHistory, 0);
                //updateStatsHistory_timer = setInterval(updateStatsHistory, UPDATE_STATSHITORY_TIME);

            } else {
                // Hide user menus
                $("#userMenu").hide();
                document.getElementById('username').innerHTML = "";
                $("#login").show();



                $("#tableDiv").hide();

            }
        }


    </script>

</head>
<body>
<div class="boxBody">

    <div class="rowBody headerBody">
        <nav class="navbar navbar-expand-sm bg-light navbar-light shadow-sm">
            <!-- Brand/logo -->
            <a class="navbar-brand " href="http://localhost"><img id="imageLogo" src="img/vf-OS_logo_01.png" alt="Logo"></a>

            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link active" href="http://localhost">Portal</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="http://localhost/systemdashboard/index.html">Dashboard</a>
                </li>
            </ul>
            <ul class="navbar-nav ml-auto">

                <li class="nav-item" id="login">
                    <a class="nav-link" href="#" onClick="keycloak.login();">Login</a>
                </li>

                <!-- Dropdown -->
                <li id="userMenu" class="nav-item dropdown" style="display: none;">
                    <a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
                        <span id="username"></span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right">
                        <a class="dropdown-item" href="#" onClick="keycloak.accountManagement();">Account Settings</a>
                        <a class="dropdown-item" href="#" onClick="keycloak.logout();" >Logout</a>
                    </div>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="http://vf-os.eu" target="_blank">About</a>
                </li>
            </ul>

        </nav>
    </div>

    <div class="rowBody contentBody">
        <div class="container-fluid">
            <div class="row">
                <div id="tableDiv" class="col-sm-12" style="display: none;">
                    <h2>vApps</h2>
                    <div class="d-flex flex-wrap">
                        <div class="card card-max-width">
                            <a href="http://localhost/assetA" target="_blank">
                                <img class="card-img-top" src="img/vApps/1.png"
                                     alt="Asset A">
                                <div class="card-body">
                                    <h5 class="card-title">Asset A</h5>
                                </div>
                            </a>
                        </div>
                        <div class="card card-max-width">
                            <a href="http://localhost/assetB/person/all" target="_blank">
                                <img class="card-img-top" src="img/vApps/2.png"
                                     alt="Asset B">
                                <div class="card-body">
                                    <h5 class="card-title">Asset B</h5>
                                </div>
                            </a>
                        </div>
                        <div class="card card-max-width">
                            <a href="http://localhost/assetC" target="_blank">
                                <img class="card-img-top" src="img/vApps/3.png" alt="Asset C">
                                <div class="card-body">
                                    <h5 class="card-title">Asset C</h5>
                                </div>
                            </a>
                        </div>
                        <div class="card card-max-width">
                            <a href="http://localhost:8080/dashboard/"
                               target="_blank">
                                <img class="card-img-top" src="img/vApps/4.png" alt="Traffik Proxy Dashboard">
                                <div class="card-body">
                                    <h5 class="card-title">Reverse Proxy Dashboard</h5>
                                </div>
                            </a>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="rowBody footerBody">
        <div class="container-fluid text-center bg-light">
            <small>Copyright Â© vf-OS 2018</small>
        </div>
    </div>
</div>

</body>
</html>